<html ng-app="SubmissionsApp">
	<head>
		<meta charset="utf-8">
		<!--
		  File:  D:\H-Drive\91-461\461-2014-15f\assn09\MySolution\jmh-assn09-v4.html
		  Jesse M. Heines, UMass Lowell Computer Science, heines@cs.uml.edu
		  Copyright (c) 2014 by Jesse M. Heines.  All rights reserved.  May be freely 
			copied or excerpted for educational purposes with credit to the author.
		  updated by JMH on November 29, 2014 at 3:29 PM
		  
		  Note the need to name the SubmissionsApp in the html ng-app attribute above
		  if we're going to use it in the angular.module function below.
		
		THIS CODE IS A BRANCH FROM Jesse M. Heines STARTER CODE
		-->
		<title>Assignment Submissions</title>

		<!-- CDN hosted AngularJS -->
		<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.js"></script>

		<!--CDN bootstrap-->
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

		<!-- CSS for this app -->
		<link type="text/css" rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootswatch/3.3.0/united/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="css/lesson9.css">


		<!-- my own collection of utility functions -->
		<script src="js/utilities.js"></script>

		<!--where all the fancy angular stuff goes-->
		<script src="js/loadTable.js"></script>

		<!-- filter functions for this app -->
		<script src="js/filters.js"></script>

	</head>

	<body>
		<!-- the main view, controlled by AngularJS -->
		<div class="container" ng-controller="SubmissionsCtrl">
			<div class="row">
				<div class="jumbotron">
					<!-- page head and version information -->
					<h1 class="text-center" id="maintitle">World Life Expectancy by Country</h1>

					<!-- 
			  show number of records in the JSON data
				http://stackoverflow.com/questions/19956074/how-can-i-show-a-count-of-rows-from-an-ng-repeat
			  show date and time
				http://stackoverflow.com/questions/22962468/angularjs-display-current-date
				https://docs.angularjs.org/api/ng/filter/date 
					-->
					<h2>Try clicking the <strong>bold</strong> words to organize the table. <small>
							(There are {{(jsonData.data.fact).length}} records.) 
						</small>
					</h2>
				</div>

				<div class="row pull-right col-lg-6 input-group">
					<span class="input-group-addon">Search</span>
					<input ng-model="query" type="text" class="form-control" placeholder="Ex: Sierra Leone">
				</div>

				<!-- the table controlled by the AngularJS controller -->
				<table class="table table-striped" id="tblSubmissions">
					<!-- the column heads -->
					<thead>
						<tr>
							<th>#</th>
							<th ng-click="sortColumn(2)">Country</th>
							<th ng-click="sortColumn(3)">Life expectancy at birth (years)</th>
							<th ng-click="sortColumn(4)">Year</th>
							<th>Sex</th>
							<th>Region</th>
						</tr>
					</thead>
					<!-- 
					  AngularJS template for each row of the table 
					  the ng-model attribute causes the data to be re-rendered when the jsonData changes
					-->
					<tbody ng-model="jsonData">
						<tr ng-repeat="oneSubmit in jsonData.data.fact| orderBy : sortField : sortDescending | filter:query">

							<!-- the built-in AngularJS loop index -->
							<td>{{$index| increment}}</td>

							<!--The country from which we are looking at data-->
							<td>{{oneSubmit.COUNTRY}}</td>

							<!--Average life expectancy-->
							<td>{{oneSubmit.Value}}</td>

							<!--The year the data was aquired-->
							<td>{{oneSubmit.YEAR}}</td>

							<!--If the data was for males or females-->
							<td>{{oneSubmit.SEX}}</td>

							<!--The region of the world that the country is in--> 
							<td>{{oneSubmit.REGION}}</td>

						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</body>
</html>
